{
	"autoexec": [
		"r.MirrorRecursion 2",
		"r.MirrorMapResolution 1024",
		"wait 1000 setsignal airlock1-out.door_open 1",
		"r.LightAttenuation 0.15"
	],
	"unloadexec": [
		"r.MirrorMapResolution 512",
		"r.LightAttenuation 0.5"
	],
	"entities": [
		<%- include('prefab/airlock', {
			name: 'airlock1',
			translate: [0, 0.0, 1.5],
			rotate: [180, 0, 1, 0]
		}) %>,
		<%- include('prefab/airlock', {
			name: 'airlock2',
			translate: [7.5, 0, 12],
			rotate: [90, 0, 1, 0],
			in_signal: "sensor2"
		}) %>,
		{
			"triggerarea": {
				"min": [6, 0, 9],
				"max": [9, 2, 11.5],
				"command": "setsignal airlock2-in.door_open 0; wait 1000 loadscene 04-symmetry"
			}
		},
		<%- include("prefab/floor", {
			y: 0,
			corners: [[0, 0], [12, 9]]
		}) %>,
		<%- include("prefab/floor", {
			y: 0,
			corners: [[-3, 3], [0, 9]]
		}) %>,
		<%- include("prefab/ceiling", {
			y: 4,
			corners: [[-3, 0], [12, 9]]
		}) %>,

		<%- include("prefab/wall", {
			y: 0,
			points: [[6, 9], [-3, 9], [-3, 6], [0, 6], [0, 3, "wall-4x3-door"], [0, 0], [6, 0, "wall-4x3-door"], [6, 3], [6, 9]]
		}) %>,
		<%- include('prefab/slide_door', {
			name: 'door1',
			translate: [6, 0.0, 1.5],
			rotate: [0, 0, 1, 0],
			input_signal: "sensor1"
		}) %>,

		<%- include('prefab/spotlight', {
			name: 'light1',
			tint: [1, 0.8, 0.8],
			intensity: 600,
			spotAngle: 20,
			translate: [3, 0.5, 0.2],
			rotate: [[180, 0, 1, 0]]
		}) %>,
		<%- include('prefab/light_sensor',
		{
			name: "sensor1",
			translate: [-2.9, 1, 7.5],
			rotate: [90, 0, 1, 0],
			trigger: 0.2
		}) %>,
		<%- include("prefab/cube", {
			name: "mirrorcube1",
			sides: 1,
			translate: [4.4, 0, 4],
			rotate: [130, 0, 1, 0]
		}) %>,

		<%- include("prefab/wall", {
			y: 0,
			points: [[6, 3], [9, 3], [9, 6], [6, 6]]
		}) %>,
		<%- include("prefab/wall", {
			y: 0,
			points: [[6, 9, "wall-4x3-door"], [9, 9], [12, 9], [12, 0], [6, 0]]
		}) %>,

		<%- include('prefab/spotlight', {
			name: 'light2',
			tint: [0.8, 0.8, 1],
			intensity: 10,
			spotAngle: 25,
			translate: [7.5, 3.8, 1.5],
			rotate: [[90, 0, 1, 0], [-55, 1, 0, 0]]
		}) %>,
		<%- include('prefab/light_sensor',
		{
			name: "sensor2",
			translate: [10.5, 1, 8.9],
			rotate: [180, 0, 1, 0],
			trigger: 0.1
		}) %>,
		<%- include("prefab/cube", {
			name: "mirrorcube2",
			sides: 1,
			translate: [7.8, 0.5, 1.5],
			rotate: [[23, 0, 1, 0], [90, 1, 0, 0]]
		}) %>,
		<%- include("prefab/cube", {
			name: "mirrorcube3",
			sides: 1,
			translate: [8.9, 0.0, 7.5],
			rotate: [[23, 0, 1, 0]]
		}) %>,

		{
			"_name": "player",
			"view": {
				"clip": [0.1, 256]
			},
			"transform": {
				"rotate": [270, 0, 1, 0],
				"translate": [-1.7, 1.7, 1.4]
			}
		},
		{
			"_comment": "blue room",
			"voxels": {
				"min": [-2.95, 0, 0.05],
				"max": [5.95, 4, 8.95]
			}
		},
		{
			"_comment": "red room",
			"voxels": {
				"min": [6.05, 0, 0.05],
				"max": [11.95, 4, 8.95]
			}
		}
	]
}
