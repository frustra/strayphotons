{
	"autoexec": [
		"r.MirrorRecursion 6",
		"wait 1000 setsignal airlock1-out.door_open 1"
	],
	"entities": [
		<%- include('prefab/airlock', {
			name: 'airlock1',
			translate: [4.5, 0, 9],
			rotate: [-90, 0, 1, 0]
		}) %>,
		<%- include('prefab/airlock', {
			name: 'airlock2',
			translate: [4.5, 0, -3],
			rotate: [-90, 0, 1, 0],
			in_signal: "combinator"
		}) %>,
		{
			"_name": "combinator",
			"signal_bindings": {
				"value": {
					"_operator": "binary_and",
					"value": ["sensor1", "sensor2"]
				}
			}
		},
		{
			"triggerarea": {
				"min": [4, 0, -2.5],
				"max": [6, 4, -0.5],
				"command": "setsignal airlock2-in.door_open 0; wait 1000 loadscene menu"
			}
		},
		<%- include("prefab/floor", {
			y: 0,
			corners: [[-6, 0], [15, 9]]
		}) %>,
		<%- include("prefab/ceiling", {
			y: 4,
			corners: [[-6, -3], [15, 12]]
		}) %>,

		<%- include("prefab/wall", {
			y: 0,
			points: [
				[0, 9],
				[0, 6],
				[0, 0],
				[3, 0, "wall-4x3-door"], [6, 0],
				[12, 0],
				[12, 3],
				[6, 3],
				[6, 6],
				[12, 6],
				[12, 9], [6, 9, "wall-4x3-door"], [3, 9],
				[0, 9]
			]
		}) %>,

		<%- include('prefab/light_sensor',
		{
			name: "sensor1",
			translate: [11.9, 0.7, 1.5],
			rotate: [-90, 0, 1, 0],
			trigger: 0.10
		}) %>,
		<%- include('prefab/light_sensor',
		{
			name: "sensor2",
			type: "light",
			translate: [11.9, 0.7, 7.5],
			rotate: [-90, 0, 1, 0],
			trigger: 0.10
		}) %>,
		<%- include("prefab/cube", {
			name: "mirrorcube1",
			sides: 2,
			translate: [2, 0, 5],
			rotate: [134, 0, 1, 0]
		}) %>,
		<%- include("prefab/cube", {
			name: "mirrorcube2",
			sides: 1,
			translate: [1.5, 0, 1.5],
			rotate: [-160, 0, 1, 0]
		}) %>,
		<%- include("prefab/cube", {
			name: "mirrorcube3",
			sides: 1,
			translate: [1.5, 1, 1.5],
			rotate: [-143, 0, 1, 0]
		}) %>,
		{
			"_name": "player",
			"view": {
				"clip": [0.1, 256]
			},
			"transform": {
				"rotate": [0, 0, 1, 0],
				"translate": [4.5, 1.7, 10.5]
			}
		},
		{
			"_comment": "blue room",
			"voxels": {
				"min": [-5.95, 0, 0],
				"max": [13, 4, 10]
			}
		},
		<%- include('prefab/spotlight', {
			name: 'light1',
			tint: [1, 0.8, 0.8],
			intensity: 300,
			spotAngle: 12,
			translate: [0.1, 0.8, 4.5],
			rotate: [[-90, 0, 1, 0], [0, 1, 0, 0]]
		}) %>
	]
}
